<?xml version="1.0" encoding="UTF-8"?>
<!--
  SMB fingerprints obtained from the Native LM (LAN manager) field of SMB
  negotations
-->
<fingerprints matches="smb.native_lm" protocol="smb" database_type="service">
  <!-- Mac OS X -->
  <fingerprint pattern="^Samba (3\.0\.28a-apple)$">
    <description>Samba on OS X 10.6</description>
    <example service.version="3.0.28a-apple">Samba 3.0.28a-apple</example>
    <param pos="0" name="os.vendor" value="Apple"/>
    <param pos="0" name="os.family" value="Mac OS X"/>
    <param pos="0" name="os.product" value="Mac OS X"/>
    <param pos="0" name="os.device" value="General"/>
    <param pos="0" name="os.version" value="10.6"/>
    <param pos="0" name="service.vendor" value="Samba"/>
    <param pos="0" name="service.product" value="Samba"/>
    <param pos="1" name="service.version"/>
  </fingerprint>
  <fingerprint pattern="^Samba (3\.0\.25b-apple)$">
    <description>Samba on OS X 10.5</description>
    <example service.version="3.0.25b-apple">Samba 3.0.25b-apple</example>
    <param pos="0" name="os.vendor" value="Apple"/>
    <param pos="0" name="os.family" value="Mac OS X"/>
    <param pos="0" name="os.product" value="Mac OS X"/>
    <param pos="0" name="os.device" value="General"/>
    <param pos="0" name="os.version" value="10.5"/>
    <param pos="0" name="service.vendor" value="Samba"/>
    <param pos="0" name="service.product" value="Samba"/>
    <param pos="1" name="service.version"/>
  </fingerprint>
  <!-- TODO: Detect vendor, distribution, and package versions -->
  <fingerprint pattern="^Samba (\d\.\d+.\d+\w*)">
    <description>Samba</description>
    <example>Samba 3.0.24</example>
    <example>Samba 3.0.28a</example>
    <example>Samba 3.0.32-0.2-2210-SUSE-SL10.3</example>
    <example>Samba 3.6.3</example>
    <example>Samba 3.6.6</example>
    <example>Samba 3.6.9-151.el6_4.1</example>
    <param pos="0" name="service.vendor" value="Samba"/>
    <param pos="0" name="service.product" value="Samba"/>
    <param pos="1" name="service.version"/>
  </fingerprint>
  <!-- this isn't perfect.  it will match anything that is exactly
       8 characters including at least one upper case and one lowercase digit.
       dionaea generates a random upper/lowercase string of exactly
       8 characters.  so this will miss all upper case or all lowercase, and
       will false-positive on things like "Sambaaaa", which could be a legit
       dionaea string or someone's messing with us
      -->
  <fingerprint pattern="^^(?=.*[a-z])(?=.*[A-Z]).{8}$">
    <description>dionaea and derivative honeypots</description>
    <example>ZElOmCSA</example>
    <param pos="0" name="service.vendor" value="DinoTools"/>
    <param pos="0" name="service.product" value="dionaea"/>
    <param pos="0" name="service.certainty" value="0.50"/>
  </fingerprint>
</fingerprints>
